============================================================
  ‚úì Total parameters: 1,812,064,415
  ‚úì Trainable: 1,806,559,391

  Initializing tokenizer...
  üìö Loading tokenizer from checkpoints/tokenizer.json
[NokaiTokenizer] Loaded from checkpoints/tokenizer.json (vocab_size=5996)
  ‚úì Tokenizer loaded (vocab=5996)

  ‚úì Setup complete!

  ‚ö° Configuring CUDA backend for H100...
  ‚úì cuDNN benchmark enabled
  ‚úì TF32 precision enabled
  ‚úì Flash SDP attention enabled
  ‚úì Memory allocator optimized

  üöÄ Applying H100 optimizations...
  ‚úì Model converted to torch.bfloat16

  üîß Compiling model (mode=max-autotune)...

  üîß Compiling model with torch.compile (mode=max-autotune)...
  ‚úì Dynamo configured for scalar outputs (.item() support)
  ‚úì Triton backend available
  ‚úì Model compiled successfully
    Mode: max-autotune, fullgraph: False
  ‚úì Compilation complete (1.2s)

  üîß Creating fused AdamW optimizer...
  ‚úì Using fused AdamW optimizer
  Post-setup Memory: 5.77GB allocated, 11.82GB cached

  ‚úÖ H100-optimized setup complete!

  üöÄ Starting H100-optimized training for 100000 steps...
     Effective batch size: 32

  Loading datasets...
  üì• Loading OpenWebText...
  ‚ö†Ô∏è Could not load OpenWebText: Dataset scripts are no longer supported, but found openwebtext-10k.py
  üì• Loading Wikipedia (en)...
Resolving data files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 41/41 [00:00<00:00, 21721.17it/s]
  ‚úì Wikipedia loaded (streaming)
  üì• Loading C4...
Resolving data files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1024/1024 [00:00<00:00, 52336.16it/s]
Resolving data files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1024/1024 [00:00<00:00, 63723.55it/s]
  ‚úì C4 loaded (streaming)
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition into 5 partitions
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] Triton compilation failed: triton_poi_fused_scalar_tensor_6
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] def triton_poi_fused_scalar_tensor_6(out_ptr0, xnumel, XBLOCK : tl.constexpr):
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xnumel = 1
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xoffset = tl.program_id(0) * XBLOCK
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xmask = tl.full([XBLOCK], True, tl.int1)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     tmp0 = zuf1
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     tmp1 = tmp0.to(tl.float64)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     tl.store(out_ptr0 + (tl.full([XBLOCK], 0, tl.int32)), tmp1, None)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] 
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] metadata: {'signature': {'out_ptr0': '*fp64', 'xnumel': 'constexpr', 'XBLOCK': 'constexpr'}, 'device': 0, 'constants': {'xnumel': 1, 'XBLOCK': 1}, 'configs': [{(0,): [['tt.divisibility', 16]]}], 'device_type': 'cuda', 'num_warps': 1, 'num_stages': 1, 'debug': True, 'cc': 90}
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] Traceback (most recent call last):
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     binary = triton.compile(*compile_args, **compile_kwargs)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     module = src.make_ir(target, options, codegen_fns, module_map, context)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] triton.compiler.errors.CompilationError: at 6:11:
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] def triton_poi_fused_scalar_tensor_6(out_ptr0, xnumel, XBLOCK : tl.constexpr):
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xnumel = 1
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xoffset = tl.program_id(0) * XBLOCK
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     xmask = tl.full([XBLOCK], True, tl.int1)
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]     tmp0 = zuf1
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0]            ^
E1209 01:02:19.080000 14306 torch/_inductor/runtime/triton_heuristics.py:780] [0/0] NameError('zuf1 is not defined')
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT forward /workspace/Nokai/nokai/brain.py line 294 
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 856, in inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return jump_graph_break(self, inst, value, extra_msg=f"\n{e}")
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 667, in jump_graph_break
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/ue/cue5fj6owl3q55vmjkszkh5sqzaxsseg6jiqzlnw6g5pwcybf64j.py", line 528, in <module>
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     triton_poi_fused_scalar_tensor_6 = async_compile.triton('triton_poi_fused_scalar_tensor_6', '''
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 500, in triton
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 448, in precompile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: CompilationError: at 6:11:
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_6(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf1 is not defined')
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 856, in inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return jump_graph_break(self, inst, value, extra_msg=f"\n{e}")
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 667, in jump_graph_break
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/ue/cue5fj6owl3q55vmjkszkh5sqzaxsseg6jiqzlnw6g5pwcybf64j.py", line 528, in <module>
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     triton_poi_fused_scalar_tensor_6 = async_compile.triton('triton_poi_fused_scalar_tensor_6', '''
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 500, in triton
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 448, in precompile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: CompilationError: at 6:11:
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_6(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf1
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf1 is not defined')
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:19.093000 14306 torch/_dynamo/convert_frame.py:1708] 
cudagraph partition due to non gpu ops
cudagraph partition into 2 partitions
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/attention/__init__.py", line 399, in energy_check
    variance = state.var(dim=-1).mean().item() if state.dim() > 1 else state.var().item()


Autotune Choices Stats:
{"num_choices": 19, "num_triton_choices": 17, "best_kernel": "triton_mm_38", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.007199999876320362, "best_triton_pos": 0}
AUTOTUNE addmm(8x128, 8x520, 520x128)
strides: [0, 1], [520, 1], [128, 1]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_38 0.0072 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  bias_addmm 0.0073 ms 98.7% 
  triton_mm_42 0.0074 ms 97.8% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_36 0.0079 ms 91.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_37 0.0079 ms 91.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_41 0.0081 ms 88.6% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_50 0.0084 ms 86.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_45 0.0086 ms 83.6% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_48 0.0086 ms 83.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_35 0.0091 ms 79.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=False, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
SingleProcess AUTOTUNE benchmarking takes 0.1614 seconds and 0.0009 seconds precompiling for 19 choices
Autotune Choices Stats:
{"num_choices": 13, "num_triton_choices": 11, "best_kernel": "triton_mm_53", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1", "best_time": 0.005727999843657017, "best_triton_pos": 0}
AUTOTUNE addmm(8x7, 8x128, 128x7)
strides: [0, 1], [128, 1], [1, 128]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_53 0.0057 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_61 0.0059 ms 97.8% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_57 0.0059 ms 97.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=1
  triton_mm_52 0.0060 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=1
  triton_mm_54 0.0060 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_60 0.0060 ms 94.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=1
  triton_mm_59 0.0061 ms 94.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=1
  triton_mm_58 0.0061 ms 93.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=1
  triton_mm_56 0.0069 ms 83.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=1
  triton_mm_51 0.0075 ms 76.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=16, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=1, num_warps=1
SingleProcess AUTOTUNE benchmarking takes 0.1034 seconds and 0.0002 seconds precompiling for 13 choices
Autotune Choices Stats:
{"num_choices": 19, "num_triton_choices": 17, "best_kernel": "triton_mm_4", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.006719999946653843, "best_triton_pos": 0}
AUTOTUNE addmm(8x128, 8x512, 512x128)
strides: [0, 1], [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_4 0.0067 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_8 0.0070 ms 95.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  bias_addmm 0.0073 ms 92.5% 
  triton_mm_12 0.0076 ms 88.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_3 0.0078 ms 85.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_7 0.0081 ms 83.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_16 0.0081 ms 83.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_2 0.0082 ms 82.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_1 0.0083 ms 80.8% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
  triton_mm_11 0.0087 ms 77.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1625 seconds and 0.0001 seconds precompiling for 19 choices
Autotune Choices Stats:
{"num_choices": 12, "num_triton_choices": 11, "best_kernel": "triton_mm_65", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1", "best_time": 0.006175999995321035, "best_triton_pos": 0}
AUTOTUNE addmm(8x1, 8x512, 512x1)
strides: [1, 1], [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_65 0.0062 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_71 0.0063 ms 98.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=1
  triton_mm_72 0.0064 ms 96.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_64 0.0073 ms 85.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=1
  triton_mm_68 0.0074 ms 83.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=1
  triton_mm_63 0.0074 ms 83.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=1
  triton_mm_70 0.0079 ms 78.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=1
  triton_mm_69 0.0088 ms 69.9% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=1
  addmm 0.0092 ms 67.5% 
  triton_mm_67 0.0125 ms 49.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=1
SingleProcess AUTOTUNE benchmarking takes 0.0985 seconds and 0.0002 seconds precompiling for 12 choices
cudagraph partition due to DeviceCopy ops. Found from : 
   File "/workspace/Nokai/nokai/attention/__init__.py", line 260, in forward
    min_alloc = self.min_allocations.to(state.device).unsqueeze(0)

cudagraph partition into 2 partitions
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT torch_dynamo_resume_in_forward_at_267 /workspace/Nokai/nokai/attention/__init__.py line 267 
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 902, in wrapper
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return handle_graph_break(self, inst, speculation.reason)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 964, in handle_graph_break
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1420, in codegen_and_compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     graph.run(*example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 937, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return super().run(*args)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/interpreter.py", line 174, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.env[node] = self.run_node(node)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                      ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1624, in run_node
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = super().run_node(n)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/interpreter.py", line 256, in run_node
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return getattr(self, n.op)(n.target, args, kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1289, in call_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise LoweringException(e, target, args, kwargs).with_traceback(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1279, in call_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     out = lowerings[target](*args, **kwargs)  # type: ignore[index]
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/lowering.py", line 488, in wrapped
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     out = decomp_fn(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/lowering.py", line 1839, in select
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     V.graph.sizevars.shape_env, V.graph.current_node.meta["unbacked_bindings"]
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                 ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: LoweringException: KeyError: 'unbacked_bindings'
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   target: aten.select.int
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[0]: TensorBox(StorageBox(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     InputBuffer(name='arg6_1', layout=FixedLayout('cuda:0', torch.bfloat16, size=[100], stride=[1]))
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   ))
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[1]: 0
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[2]: u0
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 902, in wrapper
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return handle_graph_break(self, inst, speculation.reason)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 964, in handle_graph_break
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1420, in codegen_and_compile
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     graph.run(*example_inputs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 937, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return super().run(*args)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/interpreter.py", line 174, in run
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     self.env[node] = self.run_node(node)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                      ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1624, in run_node
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     result = super().run_node(n)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/interpreter.py", line 256, in run_node
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     return getattr(self, n.op)(n.target, args, kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1289, in call_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     raise LoweringException(e, target, args, kwargs).with_traceback(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 1279, in call_function
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     out = lowerings[target](*args, **kwargs)  # type: ignore[index]
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/lowering.py", line 488, in wrapped
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     out = decomp_fn(*args, **kwargs)
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/lowering.py", line 1839, in select
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     V.graph.sizevars.shape_env, V.graph.current_node.meta["unbacked_bindings"]
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]                                 ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: LoweringException: KeyError: 'unbacked_bindings'
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   target: aten.select.int
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[0]: TensorBox(StorageBox(
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]     InputBuffer(name='arg6_1', layout=FixedLayout('cuda:0', torch.bfloat16, size=[100], stride=[1]))
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   ))
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[1]: 0
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708]   args[2]: u0
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:32.609000 14306 torch/_dynamo/convert_frame.py:1708] 
cudagraph partition due to non gpu ops
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/attention/__init__.py", line 357, in torch_dynamo_resume_in_get_efficiency_at_355
    total_possible = self.total_steps.item() * self.num_modules


cudagraph partition due to non gpu ops
cudagraph partition into 2 partitions
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT torch_dynamo_resume_in_get_efficiency_at_358 /workspace/Nokai/nokai/attention/__init__.py line 358 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4103, in RETURN_VALUE
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._return(inst)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4081, in _return
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/b2/cb2bgqfaert4jx7xjo5l7sbrygluu7icssiyhh7yj5qzaglg6cax.py", line 87, in <module>
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_0
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:12:
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_0(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = (zuf0 / tl.full([], 7.00000000000000, tl.float64))
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]             ^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4103, in RETURN_VALUE
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._return(inst)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4081, in _return
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/b2/cb2bgqfaert4jx7xjo5l7sbrygluu7icssiyhh7yj5qzaglg6cax.py", line 87, in <module>
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_0
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:12:
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_0(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = (zuf0 / tl.full([], 7.00000000000000, tl.float64))
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708]             ^
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:32.938000 14306 torch/_dynamo/convert_frame.py:1708] 
cudagraph partition due to non gpu ops
cudagraph partition into 2 partitions
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/thalamus/__init__.py", line 264, in energy_check
    input_variance = x.var(dim=-1).mean().item()


W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT forward /workspace/Nokai/nokai/thalamus/__init__.py line 146 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1495, in _compile
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     raise InternalTorchDynamoError(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 904, in wrapper
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return inner_fn(self, inst)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 462, in impl
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.push(fn_var.call_function(self, self.popn(nargs), {}))
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 966, in <lambda>
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return lambda tx, args, kwargs: obj.call_function(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1307, in _handle_insert_op_in_graph
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return wrap_fx_proxy(tx, proxy)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2645, in wrap_fx_proxy
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2711, in wrap_fx_proxy_cls
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return _wrap_fx_proxy(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2811, in _wrap_fx_proxy
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handle_traced_output(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2823, in handle_traced_output
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     var = construct_tensor_variable(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3072, in construct_tensor_variable
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     set_example_value(proxy.node, example_value)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/utils.py", line 2693, in set_example_value
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     := torch.fx.experimental.symbolic_shapes.compute_unbacked_bindings(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/experimental/symbolic_shapes.py", line 1301, in compute_unbacked_bindings
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     raise PendingUnbackedSymbolNotFound(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] torch._dynamo.exc.InternalTorchDynamoError: PendingUnbackedSymbolNotFound: Pending unbacked symbols {u409} not in returned outputs FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) ((), u410).
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Did you accidentally call new_dynamic_size() or item() more times than you needed to in your fake implementation?
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] For more help, see https://docs.google.com/document/d/1RWrH-3wLEpzR9kCS6gGBNen_-Fs-8PVbWWFE5AcgeWE/edit
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] from user code:
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]    File "/workspace/Nokai/nokai/thalamus/__init__.py", line 227, in forward
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.passage_counts[route] += 1
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1495, in _compile
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     raise InternalTorchDynamoError(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 904, in wrapper
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return inner_fn(self, inst)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 462, in impl
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.push(fn_var.call_function(self, self.popn(nargs), {}))
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 966, in <lambda>
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return lambda tx, args, kwargs: obj.call_function(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1307, in _handle_insert_op_in_graph
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return wrap_fx_proxy(tx, proxy)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2645, in wrap_fx_proxy
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2711, in wrap_fx_proxy_cls
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return _wrap_fx_proxy(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2811, in _wrap_fx_proxy
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     return handle_traced_output(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2823, in handle_traced_output
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     var = construct_tensor_variable(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3072, in construct_tensor_variable
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     set_example_value(proxy.node, example_value)
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/utils.py", line 2693, in set_example_value
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     := torch.fx.experimental.symbolic_shapes.compute_unbacked_bindings(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/experimental/symbolic_shapes.py", line 1301, in compute_unbacked_bindings
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     raise PendingUnbackedSymbolNotFound(
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] torch._dynamo.exc.InternalTorchDynamoError: PendingUnbackedSymbolNotFound: Pending unbacked symbols {u409} not in returned outputs FakeTensor(..., device='cuda:0', size=(), dtype=torch.bfloat16) ((), u410).
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Did you accidentally call new_dynamic_size() or item() more times than you needed to in your fake implementation?
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] For more help, see https://docs.google.com/document/d/1RWrH-3wLEpzR9kCS6gGBNen_-Fs-8PVbWWFE5AcgeWE/edit
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] from user code:
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]    File "/workspace/Nokai/nokai/thalamus/__init__.py", line 227, in forward
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708]     self.passage_counts[route] += 1
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:33.802000 14306 torch/_dynamo/convert_frame.py:1708] 
Autotune Choices Stats:
{"num_choices": 21, "num_triton_choices": 19, "best_kernel": "triton_mm_157", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8", "best_time": 0.012512000277638435, "best_triton_pos": 0}
AUTOTUNE addmm(8192x256, 8192x512, 512x256)
strides: [0, 1], [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_157 0.0125 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_150 0.0125 ms 99.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_156 0.0131 ms 95.6% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_146 0.0134 ms 93.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=8
  triton_mm_149 0.0137 ms 91.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=8
  triton_mm_153 0.0141 ms 88.9% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=8
  triton_mm_148 0.0148 ms 84.8% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_152 0.0148 ms 84.6% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_151 0.0150 ms 83.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_155 0.0154 ms 81.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.2271 seconds and 1.0267 seconds precompiling for 21 choices
Autotune Choices Stats:
{"num_choices": 17, "num_triton_choices": 16, "best_kernel": "triton_mm_168", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4", "best_time": 0.008287999778985977, "best_triton_pos": 0}
AUTOTUNE addmm(8192x1, 8192x256, 256x1)
strides: [1, 1], [256, 1], [1, 256]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_168 0.0083 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_162 0.0083 ms 99.6% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_161 0.0086 ms 95.9% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_172 0.0087 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=128, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_173 0.0087 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=128, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_165 0.0089 ms 93.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_167 0.0090 ms 92.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_170 0.0092 ms 90.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=128, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=8
  triton_mm_166 0.0093 ms 89.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_169 0.0096 ms 86.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=128, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1390 seconds and 0.0002 seconds precompiling for 17 choices
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition into 2 partitions
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/prefrontal/__init__.py", line 349, in energy_check
    return (self.memory_strengths > 0.1).any().item()


cudagraph partition due to non gpu ops
cudagraph partition into 3 partitions
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT forward /workspace/Nokai/nokai/hippocampus/memory.py line 248 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4103, in RETURN_VALUE
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._return(inst)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4081, in _return
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/2d/c2dqkb4dwlecdymmo6reqblfyfdudkx7feh4nhwccvwncvojuefq.py", line 210, in <module>
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_2
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:11:
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_2(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf0
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4103, in RETURN_VALUE
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._return(inst)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 4081, in _return
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/2d/c2dqkb4dwlecdymmo6reqblfyfdudkx7feh4nhwccvwncvojuefq.py", line 210, in <module>
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_2
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:11:
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_2(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf0
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:39.203000 14306 torch/_dynamo/convert_frame.py:1708] 
cudagraph partition due to non gpu ops
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/memory/semantic.py", line 418, in energy_check
    return self.num_concepts.item() > 10


cudagraph partition due to non gpu ops
cudagraph partition into 2 partitions
skipping cudagraphs due to disabling cudagraphs due to incompatible op aten._local_scalar_dense.default Found from   File "/workspace/Nokai/nokai/limbic/dacc.py", line 326, in energy_check
    state_variance = state.var(dim=-1).mean().item()


Autotune Choices Stats:
{"num_choices": 18, "num_triton_choices": 17, "best_kernel": "triton_mm_178", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.006560000125318766, "best_triton_pos": 0}
AUTOTUNE mm(8x512, 512x256)
strides: [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_178 0.0066 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_182 0.0068 ms 95.8% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  mm 0.0069 ms 95.3% 
  triton_mm_186 0.0074 ms 88.4% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_177 0.0077 ms 85.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_176 0.0078 ms 84.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_181 0.0079 ms 83.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_190 0.0079 ms 83.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_175 0.0081 ms 80.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
  triton_mm_185 0.0084 ms 78.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1552 seconds and 0.0002 seconds precompiling for 18 choices
Autotune Choices Stats:
{"num_choices": 18, "num_triton_choices": 17, "best_kernel": "triton_mm_195", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.00598399993032217, "best_triton_pos": 0}
AUTOTUNE mm(8x256, 256x128)
strides: [256, 1], [1, 256]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_195 0.0060 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_199 0.0061 ms 97.4% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_194 0.0063 ms 94.4% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  mm 0.0064 ms 93.0% 
  triton_mm_193 0.0065 ms 92.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_198 0.0065 ms 91.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_192 0.0066 ms 91.2% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
  triton_mm_203 0.0066 ms 90.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_207 0.0067 ms 89.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_205 0.0068 ms 87.4% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1418 seconds and 0.0002 seconds precompiling for 18 choices
Autotune Choices Stats:
{"num_choices": 18, "num_triton_choices": 17, "best_kernel": "triton_mm_212", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.006560000125318766, "best_triton_pos": 0}
AUTOTUNE mm(8x512, 512x128)
strides: [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_212 0.0066 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_216 0.0068 ms 96.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  mm 0.0069 ms 94.9% 
  triton_mm_220 0.0074 ms 88.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_211 0.0076 ms 86.5% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_224 0.0079 ms 83.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=8
  triton_mm_215 0.0079 ms 82.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_210 0.0080 ms 82.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_209 0.0081 ms 81.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
  triton_mm_219 0.0085 ms 77.1% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1459 seconds and 0.0002 seconds precompiling for 18 choices
Autotune Choices Stats:
{"num_choices": 15, "num_triton_choices": 13, "best_kernel": "triton_mm_229", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2", "best_time": 0.006527999881654978, "best_triton_pos": 0}
AUTOTUNE addmm(8x64, 8x512, 512x64)
strides: [0, 1], [512, 1], [1, 512]
dtypes: torch.bfloat16, torch.bfloat16, torch.bfloat16
  triton_mm_229 0.0065 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_233 0.0069 ms 94.9% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_236 0.0071 ms 92.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
  triton_mm_237 0.0071 ms 92.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  bias_addmm 0.0074 ms 87.9% 
  triton_mm_228 0.0079 ms 82.3% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=2
  triton_mm_227 0.0081 ms 81.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=5, num_warps=4
  triton_mm_232 0.0081 ms 81.0% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=64, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=3, num_warps=4
  triton_mm_226 0.0082 ms 79.4% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=128, BLOCK_M=16, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=2, num_warps=2
  triton_mm_235 0.0087 ms 74.7% ACC_TYPE='tl.float32', ALLOW_TF32=True, BLOCK_K=32, BLOCK_M=16, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, num_stages=4, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.1250 seconds and 0.0002 seconds precompiling for 15 choices
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition due to non gpu ops
cudagraph partition into 3 partitions
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT forward /workspace/Nokai/nokai/limbic/dacc.py line 169 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 856, in inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return jump_graph_break(self, inst, value, extra_msg=f"\n{e}")
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 667, in jump_graph_break
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/jn/cjnnrp53ireflbvrhbhi2wm4woq2npow7aw7cclem5qy455c77ik.py", line 1282, in <module>
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_12
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:11:
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_12(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf0
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 856, in inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return jump_graph_break(self, inst, value, extra_msg=f"\n{e}")
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 667, in jump_graph_break
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     all_stack_locals_metadata = self.output.compile_subgraph(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 1568, in compile_subgraph
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2013, in compile_and_call_fx_graph
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = self.call_user_compiler(gm, self.example_inputs())
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2136, in call_user_compiler
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self._call_user_compiler(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_fn = compiler_fn(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_gm = compiler_fn(gm, example_inputs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/__init__.py", line 2392, in __call__
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(model_, inputs_, config_patches=self.config)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2413, in compile_fx
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return compile_fx(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 2695, in compile_fx
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 990, in _compile_fx_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise InductorError(e, currentframe()).with_traceback(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 974, in _compile_fx_inner
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mb_compiled_graph = fx_codegen_and_compile(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                         ^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1695, in fx_codegen_and_compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_fx.py", line 1505, in codegen_and_compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compiled_module = graph.compile_to_module()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                       ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2319, in compile_to_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self._compile_to_module()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2329, in _compile_to_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = self._compile_to_module_lines(wrapper_code)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/graph.py", line 2397, in _compile_to_module_lines
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = PyCodeCache.load_by_key_path(
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 3548, in load_by_key_path
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     mod = _reload_python_module(key, path, set_sys_modules=in_toplevel)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 33, in _reload_python_module
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     exec(code, mod.__dict__, mod.__dict__)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/tmp/torchinductor_root/jn/cjnnrp53ireflbvrhbhi2wm4woq2npow7aw7cclem5qy455c77ik.py", line 1282, in <module>
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     async_compile.wait(globals())
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 631, in wait
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self._wait_futures(scope)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 651, in _wait_futures
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     kernel = result.result()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/codecache.py", line 4289, in result
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return self.result_fn()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/async_compile.py", line 461, in get_result
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     raise e.with_name(kernel_name) from e
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] torch._inductor.exc.InductorError: SubprocException: An exception occurred in a subprocess:
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Name=triton_poi_fused_scalar_tensor_12
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 397, in do_job
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     result = job()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/compile_tasks.py", line 66, in _worker_compile_triton
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     kernel.precompile(warm_cache_only=True)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 439, in precompile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     self._precompile_worker()
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 470, in _precompile_worker
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     compile_results.append(self._precompile_config(c))
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 778, in _precompile_config
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     binary = triton.compile(*compile_args, **compile_kwargs)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 300, in compile
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     module = src.make_ir(target, options, codegen_fns, module_map, context)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 80, in make_ir
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] triton.compiler.errors.CompilationError: at 6:11:
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] def triton_poi_fused_scalar_tensor_12(out_ptr0, xnumel, XBLOCK : tl.constexpr):
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xnumel = 1
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xoffset = tl.program_id(0) * XBLOCK
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xindex = xoffset + tl.arange(0, XBLOCK)[:]
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     xmask = tl.full([XBLOCK], True, tl.int1)
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]     tmp0 = zuf0
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708]            ^
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] NameError('zuf0 is not defined')
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:41.782000 14306 torch/_dynamo/convert_frame.py:1708] 
  Step      0 | Loss: 103.5506 | Speed: 0.0 steps/s | Step: 31635.2ms | Mem: 6.2GB
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] WON'T CONVERT step /workspace/Nokai/nokai/oscillations/oscillator.py line 91 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] due to: 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1495, in _compile
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     raise InternalTorchDynamoError(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 2450, in LOAD_ATTR
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self._load_attr(inst)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 2438, in _load_attr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = BuiltinVariable(getattr).call_function(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 966, in <lambda>
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return lambda tx, args, kwargs: obj.call_function(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1154, in builtin_dispatch
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     rv = fn(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]          ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1032, in call_self_handler
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = self_handler(tx, *args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 2338, in call_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return obj.var_getattr(tx, name)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/nn_module.py", line 1177, in var_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return super().var_getattr(tx, name)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/user_defined.py", line 1407, in var_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     if isinstance(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]        ^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/base.py", line 227, in __instancecheck__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     instance = instance.realize()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                ^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/lazy.py", line 72, in realize
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self._cache.realize()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/lazy.py", line 33, in realize
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.vt = builder.VariableBuilder(tx, self.source)(self.value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 446, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     vt = self._wrap(value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]          ^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 671, in _wrap
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return type_dispatch(self, value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2117, in wrap_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     example_value = wrap_to_fake_tensor_and_record(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3507, in wrap_to_fake_tensor_and_record
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     fake_e = wrap_fake_exception(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/utils.py", line 2864, in wrap_fake_exception
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return fn()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3508, in <lambda>
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     lambda: tx.fake_mode.from_tensor(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]             ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/fake_tensor.py", line 2993, in from_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return self.fake_tensor_converter.from_real_tensor(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/fake_tensor.py", line 404, in from_real_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     out = self.meta_converter(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/meta_utils.py", line 1898, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     t_desc = self.describer.describe_tensor(t, trace=trace)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/meta_utils.py", line 310, in describe_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     storage = self.describe_storage(t.untyped_storage(), trace=trace)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] torch._dynamo.exc.InternalTorchDynamoError: RuntimeError: Error: accessing tensor output of CUDAGraphs that has been overwritten by a subsequent run. Stack trace: File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 104, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.theta_phases = (self.theta_phases + d_theta) % (2 * math.pi). To prevent overwriting, clone the tensor outside of torch.compile() or call torch.compiler.cudagraph_mark_step_begin() before each model invocation.
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] from user code:
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]    File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 96, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.theta_phases.unsqueeze(1) - self.theta_phases.unsqueeze(0)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] Traceback (most recent call last):
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1625, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = self._inner_convert(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 688, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = _compile(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1495, in _compile
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     raise InternalTorchDynamoError(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1434, in _compile
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     guarded_code, tracer_output = compile_inner(code, one_graph, hooks)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_utils_internal.py", line 92, in wrapper_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return function(*args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1117, in compile_inner
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return _compile_inner(code, one_graph, hooks)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1151, in _compile_inner
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     dynamo_output = compile_frame(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1032, in compile_frame
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     bytecode, tracer_output = transform_code_object(code, transform)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/bytecode_transformation.py", line 1592, in transform_code_object
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = transformations(instructions, code_options)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 1004, in transform
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer_output = trace_frame(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 312, in _fn
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return fn(*args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 815, in trace_frame
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     run_tracer()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py", line 797, in run_tracer
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     tracer.run()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1500, in run
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     while self.step():
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 1348, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.dispatch_table[inst.opcode](self, inst)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 2450, in LOAD_ATTR
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self._load_attr(inst)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/symbolic_convert.py", line 2438, in _load_attr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = BuiltinVariable(getattr).call_function(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 966, in <lambda>
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return lambda tx, args, kwargs: obj.call_function(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1347, in call_function
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return handler(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1154, in builtin_dispatch
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     rv = fn(tx, args, kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]          ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 1032, in call_self_handler
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     result = self_handler(tx, *args, **kwargs)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builtin.py", line 2338, in call_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return obj.var_getattr(tx, name)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/nn_module.py", line 1177, in var_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return super().var_getattr(tx, name)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/user_defined.py", line 1407, in var_getattr
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     if isinstance(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]        ^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/base.py", line 227, in __instancecheck__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     instance = instance.realize()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                ^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/lazy.py", line 72, in realize
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self._cache.realize()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/lazy.py", line 33, in realize
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.vt = builder.VariableBuilder(tx, self.source)(self.value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 446, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     vt = self._wrap(value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]          ^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 671, in _wrap
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return type_dispatch(self, value)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 2117, in wrap_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     example_value = wrap_to_fake_tensor_and_record(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3507, in wrap_to_fake_tensor_and_record
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     fake_e = wrap_fake_exception(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/utils.py", line 2864, in wrap_fake_exception
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return fn()
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/variables/builder.py", line 3508, in <lambda>
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     lambda: tx.fake_mode.from_tensor(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]             ^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/fake_tensor.py", line 2993, in from_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     return self.fake_tensor_converter.from_real_tensor(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/fake_tensor.py", line 404, in from_real_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     out = self.meta_converter(
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]           ^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/meta_utils.py", line 1898, in __call__
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     t_desc = self.describer.describe_tensor(t, trace=trace)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]   File "/usr/local/lib/python3.12/dist-packages/torch/_subclasses/meta_utils.py", line 310, in describe_tensor
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     storage = self.describe_storage(t.untyped_storage(), trace=trace)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]                                     ^^^^^^^^^^^^^^^^^^^
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] torch._dynamo.exc.InternalTorchDynamoError: RuntimeError: Error: accessing tensor output of CUDAGraphs that has been overwritten by a subsequent run. Stack trace: File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 104, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.theta_phases = (self.theta_phases + d_theta) % (2 * math.pi). To prevent overwriting, clone the tensor outside of torch.compile() or call torch.compiler.cudagraph_mark_step_begin() before each model invocation.
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] from user code:
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]    File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 96, in step
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708]     self.theta_phases.unsqueeze(1) - self.theta_phases.unsqueeze(0)
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
W1209 01:02:49.708000 14306 torch/_dynamo/convert_frame.py:1708] 
Traceback (most recent call last):
  File "/workspace/Nokai/scripts/train_v09_h100.py", line 514, in <module>
    main()
  File "/workspace/Nokai/scripts/train_v09_h100.py", line 506, in main
    trainer.train(args.steps)
  File "/workspace/Nokai/scripts/train_v09_h100.py", line 367, in train
    loss = self.train_step(batch)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/Nokai/scripts/train_v09_h100.py", line 290, in train_step
    outputs = model(batch)
              ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 414, in __call__
    return super().__call__(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/Nokai/nokai/brain.py", line 334, in forward
    self.oscillations.step()
  File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 96, in step
    self.theta_phases.unsqueeze(1) - self.theta_phases.unsqueeze(0)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Error: accessing tensor output of CUDAGraphs that has been overwritten by a subsequent run. Stack trace: File "/workspace/Nokai/nokai/oscillations/oscillator.py", line 104, in step
    self.theta_phases = (self.theta_phases + d_theta) % (2 * math.pi). To prevent overwriting, clone the tensor outside of torch.compile() or call torch.compiler.cudagraph_mark_step_begin() before each model invocation.
'[Errno 9] Bad file descriptor' thrown while requesting GET https://huggingface.co/datasets/wikimedia/wikipedia/resolve/b04c8d1ceb2f5cd4588862100d08de323dccfbaa/20231101.en/train-00000-of-00041.parquet
Retrying in 1s [Retry 1/5].
Fatal Python error: PyGILState_Release: thread state 0x7faf2c508510 must be current when releasing
Python runtime state: finalizing (tstate=0x0000000000ba6ac8)

Thread 0x00007fb9cb6a0140 (most recent call first):
  <no Python frame>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, faiss._swigfaiss_avx512, markupsafe._speedups, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, yaml._yaml, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, _cyutility, scipy._cyutility, scipy.sparse._csparsetools, scipy.io.matlab._mio_utils, scipy.io.matlab._streams, scipy.io.matlab._mio5_utils, cuda_utils (total: 104)